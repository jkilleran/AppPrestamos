DATABASE_URL=postgresql://softwarejordano_db_user:MkjIdK2J2D0e1YC061DxhwlUTIaaui1J@dpg-d1fl4l2li9vc739lq310-a.oregon-postgres.render.com/softwarejordano_db
JWT_SECRET=ventura12pla

# --- SMTP / Email Config ---
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=johanventurafl@gmail.com
# Reemplaza por la App Password real de 16 caracteres sin espacios
SMTP_PASS=scyypzkkzueqopzw

# Remitente por defecto (se usa si el usuario autenticado no provee uno válido)
MAIL_FROM=johanventurafl@gmail.com

# Destino de documentos (puede sobreescribirse en settings DB con document_target_email)
DOCUMENT_TARGET_EMAIL=johanventura71@gmail.com

# Comportamiento de envío
EMAIL_ASYNC=0              # 1 = siempre en cola (respuesta inmediata)
EMAIL_ASYNC_ON_FAIL=1      # Degradar a cola si timeout/conexión falla
SMTP_HARD_TIMEOUT=25000    # Corte duro del send en ms
EMAIL_SOFT_FAIL=0          # 1 = Nunca devolver 500; marca softFail y encola
EMAIL_OUTBOX=0             # 1 = usar tabla email_outbox en lugar de cola en memoria
EMAIL_MAX_ATTEMPTS=5       # Reintentos antes de marcar failed en outbox
EMAIL_WORKER_INTERVAL_MS=12000
EMAIL_BATCH_SIZE=10
EMAIL_OUTBOX_DEBUG=0

# Fallback (opcional). Intenta segunda config si la primera (465 TLS implícito) falla.
SMTP_ENABLE_FALLBACK=1
SMTP_FORCE_FALLBACK=1
SMTP_FALLBACK_PORT=465
SMTP_FALLBACK_SECURE=true

# Depuración (apagar en producción estable)
UPLOAD_DEBUG=0
LOG_REQUESTS=0

# Seguridad logging auth
AUTH_DEBUG=0
AUTH_OMIT_FOTO=1

# Restringir MIME (1 = sólo JPG/PNG/PDF; 0 = permitir cualquier tipo dentro del límite de tamaño)
RESTRICT_UPLOAD_MIME=0

# --- HTTP Email Provider (SendGrid) ---
# Activa el proveedor HTTP para evitar bloqueos SMTP del hosting.
# Rellena SENDGRID_API_KEY con la clave real (no compartas esta clave en commits ni pantallas públicas).
EMAIL_HTTP_PROVIDER=sendgrid
SENDGRID_API_KEY=REEMPLAZA_CON_TU_API_KEY
EMAIL_HTTP_FORCE=1           # 1 = omite SMTP y usa directamente HTTP
EMAIL_HTTP_SANDBOX=0         # 1 = modo sandbox (no entrega real). Usar 0 en producción
EMAIL_HTTP_DEBUG=1           # 1 = logs extra mientras pruebas; poner 0 luego
FORCED_FALLBACK_FROM=1       # Fuerza usar MAIL_FROM como remitente y el usuario va en Reply-To
DOCUMENT_FROM_EMAIL=johanventurafl@gmail.com  # explícito (puede ir igual que MAIL_FROM)
SMTP_FORCE_IPV4=1            # Asegura resolución IPv4 (mitiga algunos timeouts)

# NOTA: Después de confirmar que HTTP funciona:
# - Pon EMAIL_HTTP_DEBUG=0
# - Considera EMAIL_HTTP_FORCE=0 si en el futuro SMTP vuelve a funcionar y quieres fallback.
# - Si cambias la API key rota la anterior en SendGrid.
